<!DOCTYPE html>
<html>
<head>   
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>PHP + Symfony Tips - Tips al Usar Twig</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" />
    <!-- This is for syntax highlight -->
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css">
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />

</head>
<body class="home-template">

    <main class="content" role="main">

    <article class="post">
        <header class="post-header">
            <a id="blog-logo" href="http://manuelj555.github.io/">
                
                <span class="blog-title">PHP + Symfony Tips</span>
                 
            </a>
        </header>

        <span class="post-meta">
            <time datetime="2014-08-04">04 Aug 2014</time>
            
            on
            
            
       	</span>

        <h1 class="post-title">Tips al Usar Twig</h1>

        <section class="post-content">
            <p>Twig es una libreria de templates para php, que es muy utilizada en la actualidad, el framework Symfony lo utiliza por defecto para la parte de las vistas, y yo personalmente lo uso en todos los proyectos php que construyo.</p>

<p>El siguiente post es una recomendación personal y una serie de consejos que podemos seguir al utilizar esta libreria, y pretendo explicar más o menos lo que generalmente hago a la hora de trabajar las vistas y algunos diseños con twig.</p>

<p>Lo principal es usar todo el potencial de twig, ya que este no es solo extender templates, twig ofrece otras caracteristicas como macros y embed, que son super potentes y nos pueden ayudar muchisimo a mejorar nuestro rendimiento al desarrollar aplicaciones.</p>

<p>A continuación mostraré algunas de las cosas que he implementado para reutilizar diseños y facilitar el manejo de algunas partes de mis vistas twig:</p>

<h2 id="macros">Macros</h2>

<p>Las <a href="http://twig.sensiolabs.org/doc/tags/macro.html">macros</a> nos permiten definir “funciones” twig en las mismas vistas, y son utiles para crear bloques de código que son muy utilizados en la aplicación.</p>

<p>Un caso donde los he venido usando es al crear links como botones e inputs de tipo submit, button o reset, ya que uso muy a menudo el <a href="http://getbootstrap.com/">bootstrap de twitter</a>, acostumbro definir un archivo de macros, para estos botones, ejemplo:</p>

<p>Tenemos el siguiente archivo twig (<strong>views/macros/buttons.html.twig</strong>):</p>

<figure class="highlight"><pre><code class="language-twig" data-lang="twig"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre></td><td class="code"><pre><span class="c">{# Los "-" guiones que se ven entre las definicones de etiquetas </span><span class="err">{</span><span class="c">%- y -%} son para quitar espacios en blanco y minimizar el código generado #}</span>

<span class="c">{# Macros para botones de formulario #}</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">macro</span> <span class="nv">button</span><span class="p">(</span><span class="nv">text</span><span class="p">,</span> <span class="nv">type</span><span class="p">,</span> <span class="nv">icon</span> <span class="err">=</span> <span class="nb">null</span><span class="p">)</span> <span class="o">-</span><span class="cp">%}</span>
<span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"btn btn-</span><span class="cp">{{</span> <span class="nv">type</span><span class="o">|</span><span class="nf">default</span><span class="p">(</span><span class="s1">'default'</span><span class="p">)</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span>
    <span class="cp">{%</span> <span class="k">if</span> <span class="nv">icon</span> <span class="cp">%}</span><span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">"glyphicon glyphicon-</span><span class="cp">{{</span> <span class="nv">icon</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;&lt;/i&gt;</span> <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}{{</span> <span class="nv">text</span> <span class="cp">}}</span>
<span class="nt">&lt;/button&gt;</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">endmacro</span> <span class="o">-</span><span class="cp">%}</span>

<span class="cp">{%</span><span class="o">-</span> <span class="k">macro</span> <span class="nv">submit</span><span class="p">(</span><span class="nv">text</span> <span class="err">=</span> <span class="s1">'Guardar'</span><span class="p">,</span> <span class="nv">icon</span> <span class="err">=</span> <span class="s1">'save'</span><span class="p">)</span> <span class="o">-</span><span class="cp">%}</span>
<span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"btn btn-</span><span class="cp">{{</span> <span class="nv">type</span><span class="o">|</span><span class="nf">default</span><span class="p">(</span><span class="s1">'default'</span><span class="p">)</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span>
    <span class="cp">{%</span> <span class="k">if</span> <span class="nv">icon</span> <span class="cp">%}</span><span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">"glyphicon glyphicon-</span><span class="cp">{{</span> <span class="nv">icon</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;&lt;/i&gt;</span> <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}{{</span> <span class="nv">text</span> <span class="cp">}}</span>
<span class="nt">&lt;/button&gt;</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">endmacro</span> <span class="o">-</span><span class="cp">%}</span>

<span class="c">{# Macros para links con estilos de boton #}</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">macro</span> <span class="nv">link</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="nv">type</span><span class="p">,</span> <span class="nv">icon</span> <span class="err">=</span> <span class="nb">null</span><span class="p">,</span> <span class="nv">class</span><span class="p">,</span> <span class="nv">htmlAttributes</span><span class="p">)</span> <span class="o">-</span><span class="cp">%}</span>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">url</span> <span class="cp">}}</span><span class="s">"</span> <span class="na">class=</span><span class="s">"btn btn-</span><span class="cp">{{</span> <span class="nv">type</span><span class="o">|</span><span class="nf">default</span><span class="p">(</span><span class="s1">'default'</span><span class="p">)</span> <span class="cp">}}</span><span class="s"> </span><span class="cp">{{</span> <span class="nv">class</span> <span class="cp">}}</span><span class="s">"</span> <span class="cp">{{</span> <span class="nv">htmlAttributes</span> <span class="cp">}}</span><span class="nt">&gt;</span>
    <span class="cp">{%</span> <span class="k">if</span> <span class="nv">icon</span> <span class="cp">%}</span><span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">"glyphicon glyphicon-</span><span class="cp">{{</span> <span class="nv">icon</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;&lt;/i&gt;</span> <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}{{</span> <span class="nv">text</span> <span class="cp">}}</span>
<span class="nt">&lt;/a&gt;</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">endmacro</span> <span class="o">-</span><span class="cp">%}</span>

<span class="cp">{%</span><span class="o">-</span> <span class="k">macro</span> <span class="nv">primaryLink</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="nv">icon</span> <span class="err">=</span> <span class="nb">null</span><span class="p">,</span> <span class="nv">class</span><span class="p">,</span> <span class="nv">htmlAttributes</span><span class="p">)</span> <span class="o">-</span><span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">import</span> <span class="nv">_self</span> <span class="k">as</span> <span class="nv">links</span> <span class="cp">%}</span>
<span class="cp">{{</span> <span class="nv">links.link</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="s1">'primary'</span><span class="p">,</span> <span class="nv">icon</span><span class="p">,</span> <span class="nv">class</span><span class="p">,</span> <span class="nv">htmlAttributes</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">endmacro</span> <span class="o">-</span><span class="cp">%}</span>

<span class="cp">{%</span><span class="o">-</span> <span class="k">macro</span> <span class="nv">successLink</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="nv">icon</span> <span class="err">=</span> <span class="nb">null</span><span class="p">,</span> <span class="nv">class</span><span class="p">,</span> <span class="nv">htmlAttributes</span><span class="p">)</span> <span class="o">-</span><span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">import</span> <span class="nv">_self</span> <span class="k">as</span> <span class="nv">links</span> <span class="cp">%}</span>
<span class="cp">{{</span> <span class="nv">links.link</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="s1">'success'</span><span class="p">,</span> <span class="nv">icon</span><span class="p">,</span> <span class="nv">class</span><span class="p">,</span> <span class="nv">htmlAttributes</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">endmacro</span> <span class="o">-</span><span class="cp">%}</span>

<span class="cp">{%</span><span class="o">-</span> <span class="k">macro</span> <span class="nv">infoLink</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="nv">icon</span> <span class="err">=</span> <span class="nb">null</span><span class="p">,</span> <span class="nv">class</span><span class="p">,</span> <span class="nv">htmlAttributes</span><span class="p">)</span> <span class="o">-</span><span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">import</span> <span class="nv">_self</span> <span class="k">as</span> <span class="nv">links</span> <span class="cp">%}</span>
<span class="cp">{{</span> <span class="nv">links.link</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="s1">'info'</span><span class="p">,</span> <span class="nv">icon</span><span class="p">,</span> <span class="nv">class</span><span class="p">,</span> <span class="nv">htmlAttributes</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">endmacro</span> <span class="o">-</span><span class="cp">%}</span>

<span class="cp">{%</span><span class="o">-</span> <span class="k">macro</span> <span class="nv">warningLink</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="nv">icon</span> <span class="err">=</span> <span class="nb">null</span><span class="p">,</span> <span class="nv">class</span><span class="p">,</span> <span class="nv">htmlAttributes</span><span class="p">)</span> <span class="o">-</span><span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">import</span> <span class="nv">_self</span> <span class="k">as</span> <span class="nv">links</span> <span class="cp">%}</span>
<span class="cp">{{</span> <span class="nv">links.link</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="s1">'warning'</span><span class="p">,</span> <span class="nv">icon</span><span class="p">,</span> <span class="nv">class</span><span class="p">,</span> <span class="nv">htmlAttributes</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">endmacro</span> <span class="o">-</span><span class="cp">%}</span>

<span class="cp">{%</span><span class="o">-</span> <span class="k">macro</span> <span class="nv">dangerLink</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="nv">icon</span> <span class="err">=</span> <span class="nb">null</span><span class="p">,</span> <span class="nv">class</span><span class="p">,</span> <span class="nv">htmlAttributes</span><span class="p">)</span> <span class="o">-</span><span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">import</span> <span class="nv">_self</span> <span class="k">as</span> <span class="nv">links</span> <span class="cp">%}</span>
<span class="cp">{{</span> <span class="nv">links.link</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="s1">'danger'</span><span class="p">,</span> <span class="nv">icon</span><span class="p">,</span> <span class="nv">class</span><span class="p">,</span> <span class="nv">htmlAttributes</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">endmacro</span> <span class="o">-</span><span class="cp">%}</span>

<span class="c">{# Macros para botones de operaciones CRUD #}</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">macro</span> <span class="nv">back</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span> <span class="err">=</span> <span class="s1">'Atras'</span><span class="p">,</span> <span class="nv">icon</span> <span class="err">=</span> <span class="s1">'undo'</span><span class="p">)</span> <span class="o">-</span><span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">import</span> <span class="nv">_self</span> <span class="k">as</span> <span class="nv">links</span> <span class="cp">%}</span>
<span class="cp">{{</span> <span class="nv">links.link</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="s1">'default'</span><span class="p">,</span> <span class="nv">icon</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">endmacro</span> <span class="o">-</span><span class="cp">%}</span>

<span class="cp">{%</span><span class="o">-</span> <span class="k">macro</span> <span class="nv">edit</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span> <span class="err">=</span> <span class="s1">'Editar'</span><span class="p">,</span> <span class="nv">icon</span> <span class="err">=</span> <span class="s1">'edit'</span><span class="p">,</span> <span class="nv">size</span> <span class="err">=</span> <span class="s1">'xs'</span><span class="p">)</span> <span class="o">-</span><span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">import</span> <span class="nv">_self</span> <span class="k">as</span> <span class="nv">links</span> <span class="cp">%}</span>
<span class="cp">{{</span> <span class="nv">links.link</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="s1">'link btn-'</span><span class="err">~</span><span class="nv">size</span><span class="p">,</span> <span class="nv">icon</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">endmacro</span> <span class="o">-</span><span class="cp">%}</span>

<span class="cp">{%</span><span class="o">-</span> <span class="k">macro</span> <span class="nv">add</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="p">,</span> <span class="nv">icon</span> <span class="err">=</span> <span class="s1">'plus'</span><span class="p">,</span> <span class="nv">size</span> <span class="err">=</span> <span class="nb">null</span><span class="p">)</span> <span class="o">-</span><span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">import</span> <span class="nv">_self</span> <span class="k">as</span> <span class="nv">links</span> <span class="cp">%}</span>
<span class="cp">{{</span> <span class="nv">links.link</span><span class="p">(</span><span class="nv">url</span><span class="p">,</span> <span class="nv">text</span><span class="o">|</span><span class="nf">default</span><span class="p">(</span><span class="s1">'Nuevo'</span><span class="p">),</span> <span class="s1">'primary btn-'</span><span class="err">~</span><span class="nv">size</span><span class="p">,</span> <span class="nv">icon</span><span class="p">)</span> <span class="cp">}}</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">endmacro</span> <span class="o">-</span><span class="cp">%}</span>

<span class="cp">{%</span><span class="o">-</span> <span class="k">macro</span> <span class="nv">save</span><span class="p">(</span><span class="nv">text</span><span class="p">)</span> <span class="o">-</span><span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">import</span> <span class="nv">_self</span> <span class="k">as</span> <span class="nv">btn</span> <span class="cp">%}</span>
<span class="cp">{{</span> <span class="nv">btn.submit</span><span class="p">(</span><span class="nv">text</span><span class="o">|</span><span class="nf">default</span><span class="p">(</span><span class="s1">'Guardar'</span><span class="p">))</span> <span class="cp">}}</span>
<span class="cp">{%</span><span class="o">-</span> <span class="k">endmacro</span> <span class="o">-</span><span class="cp">%}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Ahora los utilizamos en nuestras otras vistas:</p>

<figure class="highlight"><pre><code class="language-twig" data-lang="twig"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre><span class="cp">{%</span> <span class="k">import</span> <span class="s1">'macros/buttons.html.twig'</span> <span class="k">as</span> <span class="nv">btn</span> <span class="cp">%}</span>

<span class="cp">{{</span> <span class="nv">btn.link</span><span class="p">(</span><span class="s1">'/url'</span><span class="p">,</span> <span class="s1">'Home'</span><span class="p">)</span> <span class="cp">}}</span>

<span class="cp">{{</span> <span class="nv">btn.submit</span><span class="p">()</span> <span class="cp">}}</span>
<span class="cp">{{</span> <span class="nv">btn.back</span><span class="p">()</span> <span class="cp">}}</span>

<span class="cp">{{</span> <span class="nv">btn.button</span><span class="p">(</span><span class="s1">'Texto del boton'</span><span class="p">)</span> <span class="cp">}}</span>

<span class="cp">{{</span> <span class="nv">btn.primaryLink</span><span class="p">(</span><span class="s1">'/url'</span><span class="p">,</span> <span class="s1">'Agregar Producto'</span><span class="p">,</span> <span class="s1">'tags'</span><span class="p">)</span> <span class="cp">}}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>La ventaja de usar las macros en ves de escribir el código directamente en cada vista, es que codificamos menos, y si el día de mañana queremos cambiar por ejemplo el color del botón de submit, solo lo modificamos una vez en nuestra macro, y todas las demás vistas tendran el cambio sin hacer nada.</p>

<p>Ahora veremos un ejemplo del uso de la etiqueta <a href="http://twig.sensiolabs.org/doc/tags/embed.html">embed</a> de twig:</p>

<h2 id="embed">Embed</h2>

<p>Esta etiqueta permite redefinir los bloques de un template incluido en nuestra vista, es decir, es una combinacion de las funcionalidades ofrecidas por la función include y el tag extends.</p>

<p>Un caso donde he utilizado esta etiqueta es a la hora de usar el <a href="http://getbootstrap.com/components/#panels">panel del bootstrap de twitter</a>; la idea es definir un template que tenga el código html necesario para el panel y crear los bloques que serán luego redefinidos en las vistas que quieran incorporar el panel.</p>

<p>Acá el código que en principio he implementado (<strong>views/panel.html.twig</strong>):</p>

<figure class="highlight"><pre><code class="language-twig" data-lang="twig"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel panel-</span><span class="cp">{{</span> <span class="nv">type</span><span class="o">|</span><span class="nf">default</span><span class="p">(</span><span class="s1">'default'</span><span class="p">)</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-heading"</span><span class="nt">&gt;</span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">header</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-body"</span><span class="nt">&gt;</span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-footer"</span><span class="nt">&gt;</span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">footer</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;/div&gt;</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Ahora en cualquier vista twig podemos embeber el template que contiene el panel, y llenar los bloques con información:</p>

<figure class="highlight"><pre><code class="language-twig" data-lang="twig"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></td><td class="code"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s1">'base.html.twig'</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">page_title</span> <span class="cp">%}</span>Page title<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>

    <span class="nt">&lt;p&gt;</span>Page content!!!<span class="nt">&lt;/p&gt;</span>

    <span class="cp">{%</span> <span class="k">embed</span> <span class="s1">'panel.html.twig'</span> <span class="cp">%}</span>
        <span class="c">{# este import debe ir dentro del embed para que esté disponible en los bloques #}</span>
        <span class="cp">{%</span> <span class="k">import</span> <span class="s1">'macros/buttons.html.twig'</span> <span class="k">as</span> <span class="nv">btn</span> <span class="cp">%}</span>

        <span class="cp">{%</span> <span class="k">block</span> <span class="nv">header</span> <span class="cp">%}</span>Título del Panel<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

        <span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>Contenido del Panel<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

        <span class="cp">{%</span> <span class="k">block</span> <span class="nv">footer</span> <span class="cp">%}</span>
            <span class="cp">{{</span> <span class="nv">btn.submit</span><span class="p">()</span> <span class="cp">}}</span> <span class="cp">{{</span> <span class="nv">btn.back</span><span class="p">()</span> <span class="cp">}}</span>
        <span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

    <span class="cp">{%</span> <span class="k">endembed</span> <span class="cp">%}</span>

    Una vista puede tener tantos embed como se quiera.

    <span class="cp">{%</span> <span class="k">embed</span> <span class="s1">'panel.html.twig'</span> <span class="cp">%}</span>
        <span class="c">{# este embed no tiene footer #}</span>

        <span class="cp">{%</span> <span class="k">block</span> <span class="nv">header</span> <span class="cp">%}</span>Título del Panel<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

        <span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>Contenido del Panel<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

        <span class="c">{# No definimos el bloque footer, ya que no lo necesitamos en este caso #}</span>

    <span class="cp">{%</span> <span class="k">endembed</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Como ven, esta etiqueta nos da un gran potencial a la hora de escribir código repetitivo, sin embargo este template en particular aun tiene un problema, y es que si no definimos algún bloque (ya sea porque no lo necesitamos), igual se genera el div sin contenido y se verá en el diseño gracias a que contiene un padding.</p>

<p>Para solventar esto, el panel que he implementado es uno donde todos los bloques (header, body y footer) son opcionales:</p>

<figure class="highlight"><pre><code class="language-twig" data-lang="twig"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20</pre></td><td class="code"><pre><span class="c">{# views/panel.html.twig #}</span>
<span class="cp">{%</span> <span class="k">set</span> <span class="nv">_header</span>  <span class="err">=</span>  <span class="k">block</span><span class="p">(</span><span class="s1">'header'</span><span class="p">)</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">set</span> <span class="nv">_body</span>    <span class="err">=</span>  <span class="k">block</span><span class="p">(</span><span class="s1">'body'</span><span class="p">)</span>   <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">set</span> <span class="nv">_footer</span>  <span class="err">=</span>  <span class="k">block</span><span class="p">(</span><span class="s1">'footer'</span><span class="p">)</span> <span class="cp">%}</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel panel-</span><span class="cp">{{</span> <span class="nv">type</span><span class="o">|</span><span class="nf">default</span><span class="p">(</span><span class="s1">'default'</span><span class="p">)</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span>

    <span class="c">{# 
        La idea acá es que ningun bloque sea obligatorio
        Si alguno está vacio o no definido, 
        simplemente no se cumple la condición y no se imprime el div
     #}</span>

    <span class="cp">{%</span> <span class="k">if</span> <span class="nv">_header</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">empty</span> <span class="cp">%}</span><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-heading"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">_header</span><span class="o">|</span><span class="nf">raw</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>

    <span class="cp">{%</span> <span class="k">if</span> <span class="nv">_body</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">empty</span> <span class="cp">%}</span><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-body"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">_body</span><span class="o">|</span><span class="nf">raw</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>

    <span class="cp">{%</span> <span class="k">if</span> <span class="nv">_footer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">empty</span> <span class="cp">%}</span><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"panel-footer"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">_footer</span><span class="o">|</span><span class="nf">raw</span> <span class="cp">}}</span><span class="nt">&lt;/div&gt;</span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>

<span class="nt">&lt;/div&gt;</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>La ventaja de usar embed, es que si por alguna razón debemos cambiar o ajustar el código html para el panel, añadiendo divs, clases, etc, con hacerlo en la vista <strong>panel.html.twig</strong> el cambio se verá reflejado en todas las vistas que hayan embebido el panel.
<br />
<br />
<br />
Esta es una pequeña muestra de lo que podemos hacer para mejorar el rendimiento y mantenimiento al programar nuestras vistas, queda de tu parte idear otros posibles usos para las macros y la etiqueta embed.</p>

<h2 id="otros-tips-al-usar-twig-sin-un-framework">Otros tips al usar Twig sin un Framework</h2>

<p>Cuando eres tú el encargado de crear la instancia de twig, y definir los directorios de las vistas, es recomendable usar los <a href="http://twig.sensiolabs.org/doc/api.html#loaders">Namespaces del Loader</a>, ya que esto ayuda a mantener organizados los archivos de las vistas.</p>

<p>Una posible organización puede ser:</p>

<div class="highlighter-rouge"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre></td><td class="code"><pre>views
  |
  |------_shared
  |         |
  |         |----templates
  |         |       |----base.twig
  |         |----partials
  |         |       |----menu.twig
  |         |       |----panel.twig
  |         |----macros
  |         |       |----buttons.twig
  |
  |------home.twig
  |------edit-user.twig
  |------user
          |----list.twig
          |----create.twig
          |----edit.twig
</pre></td></tr></tbody></table>
</div>

<p>Para lograrlo, nuestro loader deberá estar más o menos así:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre><span class="cp">&lt;?php</span>

<span class="nv">$loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Twig_Loader_Filesystem</span><span class="p">();</span>

<span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">addPath</span><span class="p">(</span><span class="s1">'/path_to_views'</span><span class="p">);</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">addPath</span><span class="p">(</span><span class="s1">'/path_to_views/_shared/templates'</span><span class="p">,</span> <span class="s1">'templates'</span><span class="p">);</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">addPath</span><span class="p">(</span><span class="s1">'path_to_views/_views/_shared/partials'</span><span class="p">,</span> <span class="s1">'partials'</span><span class="p">);</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">addPath</span><span class="p">(</span><span class="s1">'path_to_views/_views/_shared/macros'</span><span class="p">,</span> <span class="s1">'macros'</span><span class="p">);</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Con esto conseguimos tener varios directorios a los que hacer referencia a la hora de incluir o extender templates, por ejemplo:</p>

<figure class="highlight"><pre><code class="language-twig" data-lang="twig"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre></td><td class="code"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s1">'@templates/base.twig'</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">import</span> <span class="s1">'@macros/buttons.twig'</span> <span class="k">as</span> <span class="nv">btn</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>

    <span class="cp">{%</span> <span class="k">embed</span> <span class="s1">'@partials/panel.twig'</span> <span class="cp">%}</span>

        <span class="cp">{%</span> <span class="k">block</span> <span class="nv">header</span> <span class="cp">%}</span>Título del Panel<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

        <span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>Contenido del Panel<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">endembed</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Esto nos da la ventaja de tener los templates más organizados y nos da la flexibilidad de que si luego cambiamos el directorio de los templates, partials o macros, mientras mantengan el mismo namespace no se dañaran nuestras vistas.</p>

        </section>

        

        <footer class="post-footer">
            
            <section class="author">
                <header> <a href="http://manuelj555.github.io/"> <img class="profile" src="/assets/images/profile.png" alt="Author's profile picture"></a></header>
                <article>
                    <h4> Manuel Aguirre <programador.manuel@gmail.com> </h4>
                    <p> 
                        Desarrollador Web, (PHP, HTML, css, javascript).<br/>
                        Intento usar Symfony2 y/o sus componentes en mis proyectos.<br/>
                        Apasionado por el aprendizaje y loco por la Programación :-)
                    </p>
                </article>
            </section>                
            

            <section class="share">
                <h4>Comparte</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=Tips al Usar Twig&amp;url=http://manuelj555.github.io/2014/08/04/twig-tips.html"
                   onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');
                           return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://manuelj555.github.io/2014/08/04/twig-tips.html"
                   onclick="window.open(this.href, 'facebook-share', 'width=580,height=296');
                           return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://manuelj555.github.io/2014/08/04/twig-tips.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');
                           return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

            
            <section class="disqus">
                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'phpsymfonytipsmanuelj555'; // required: replace example with your forum shortname

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script');
                        dsq.type = 'text/javascript';
                        dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            </section>
            

        </footer>

    </article>

</main>


    <script type="text/javascript" src="/assets/js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Google Analytics Tracking code -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-59688229-1', 'auto');
        ga('send', 'pageview');

    </script>
</body>
</html>
