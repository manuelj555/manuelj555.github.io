<!DOCTYPE html>
<html>
<head>   
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>PHP + Symfony Tips - Creando un Foro con el MicroKernelTrait de Symfony (Parte 1)</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" />
    <!-- This is for syntax highlight -->
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css">
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />

</head>
<body class="home-template">

    <main class="content" role="main">

    <article class="post">
        <header class="post-header">
            <a id="blog-logo" href="http://manuelj555.github.io/">
                
                <span class="blog-title">PHP + Symfony Tips</span>
                 
            </a>
        </header>

        <span class="post-meta">
            <time datetime="2016-08-14">14 Aug 2016</time>
            
            on
            
            
       	</span>

        <h1 class="post-title">Creando un Foro con el MicroKernelTrait de Symfony (Parte 1)</h1>

        <section class="post-content">
            <p>En esta ocasión voy a escribir una serie de artículos en donde se describirá paso a paso el desarrollo de una aplicación muy simple utilizando el <a href="http://symfony.com/doc/current/configuration/micro_kernel_trait.html">MicroKernelTrait de Symfony</a>, la cual será un Foro donde los usuarios podrán hacer preguntas y responder las preguntas de otros usuarios.</p>

<p>En esta primera parte solo vamos a instalar y configurar Symfony con el MicroKernelTrait.</p>

<p><em><strong>Nota</strong>: Los posts se enfocarán a usuarios que tengan conocimientos previos de Symfony, que conozcan sobre el AppKernel, los directorios básicos de un proyecto symfony y de los archivos de configuración y rutas.</em></p>

<hr>

<h1>La aplicación</h1>

<p>Para no complicar la aplicación no se tendrán categorías ni se aprobaran preguntas o respuestas, además estás serán las lineas a seguir para el desarrollo de la app:</p>

<ul>
<li>No habrán niveles/perfiles de usuario.</li>
<li>Cualquier usuario logueado podrá crear una pregunta.</li>
<li>Cualquier usuario logueado podrá responder una pregunta.</li>
<li>El usuario que creó la pregunta podrá en cualquier momento dar por resuelta su inquietud.</li>
<li>No habrá registro de usuarios (Existirán unos cuantos usuarios de prueba).</li>
<li>Habrá un listado de las oportunidades del usuario.</li>
</ul>

<p>Por otro lado, la aplicación constará de los siguientes módulos:</p>

<p><strong>Inicio</strong></p>

<p>Muestra un listado de las preguntas realizadas por los usuarios. En esta página aparece el título de la pregunta, la fecha y un resumen de la descripción de la misma. Las preguntas aparecerán desde las más recientes hasta las más antiguas.</p>

<p><strong>Detalle de Pregunta</strong></p>

<p>Muestra en detalle la pregunta realizada con su descripción y la información del usuario, además muestra las respuestas que los usuarios han hecho previamente, y contendrá un formulario para añadir una respuesta a la pregunta.</p>

<p><strong>Crear Pregunta</strong></p>

<p>Muestra un formulario para crear una pregunta.</p>

<p><strong>Mis preguntas</strong></p>

<p>Muestra un listado de las preguntas realizadas por el usuario logueado. En esta página aparece el título de la pregunta y un resumen de la descripción de la misma. Las preguntas aparecerán desde las más recientes hasta las más antiguas.</p>

<hr>

<h1>Preguntas</h1>

<p>La pregunta será realizada por un usuario previamente logueado y constará de las siguientes propiedades:</p>

<ul>
<li><strong>id</strong>: Identificador interno de la pregunta.</li>
<li><strong>title</strong>: Título de la pregunta.</li>
<li><strong>description</strong>: Descripción de la pregunta.</li>
<li><strong>author</strong>: Usuario autor de la pregunta.</li>
<li><strong>createdAt</strong>: Fecha de creación de la pregunta.</li>
<li><strong>resolved</strong>: Un atributo para que indica si está resuelta su duda.</li>
</ul>

<h1>Respuestas</h1>

<p>Las respuestas las harán usuarios previamente logueados y constarán de los siguientes atributos:</p>

<ul>
<li><strong>id</strong>: Identificador interno de la respuesta.</li>
<li><strong>author</strong>: El usuario que responde.</li>
<li><strong>question</strong>: La pregunta que se está respondiendo.</li>
<li><strong>response</strong>: La descripción de la respuesta.</li>
<li><strong>createdAt</strong>: fecha de creación de la respuesta.</li>
</ul>

<hr>

<h1>Requerimientos:</h1>

<ul>
<li>Se debe tener al menos <strong>php &gt;= 5.5</strong> ya que se trabajará con Symfony 3 (Aunque se puede trabajar con Symfony 2.8 para php 5.4, que tambien permite el uso de Traits).</li>
<li>Se debe tener <a href="https://getcomposer.org/download/">composer instalado</a> en la máquina.</li>
</ul>

<h3>Configurando el Proyecto</h3>

<p>Vamos a guiarnos de la <a href="http://symfony.com/doc/current/configuration/micro_kernel_trait.html">documentación oficial</a> para trabajar con el MicroKernelTrait, por lo que lo primero es crear una carpeta para la aplicación, con un nombre como por ejemplo <strong>micro-foro</strong>.</p>

<p><strong>Instalación</strong></p>

<p>Crearemos un fichero <code>composer.json</code> con el siguiente contenido:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="lineno"> 1</span> <span class="p">{</span>
<span class="lineno"> 2</span>     <span class="nt">&quot;require&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="lineno"> 3</span>         <span class="nt">&quot;symfony/symfony&quot;</span><span class="p">:</span> <span class="s2">&quot;^3.1&quot;</span><span class="p">,</span>
<span class="lineno"> 4</span>         <span class="nt">&quot;sensio/framework-extra-bundle&quot;</span><span class="p">:</span> <span class="s2">&quot;^3.0&quot;</span>
<span class="lineno"> 5</span>     <span class="p">},</span>
<span class="lineno"> 6</span>     <span class="nt">&quot;autoload&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="lineno"> 7</span>         <span class="nt">&quot;psr-4&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="lineno"> 8</span>             <span class="nt">&quot;&quot;</span><span class="p">:</span> <span class="s2">&quot;src/&quot;</span>
<span class="lineno"> 9</span>         <span class="p">}</span>
<span class="lineno">10</span>     <span class="p">}</span>
<span class="lineno">11</span> <span class="p">}</span></code></pre></figure>

<p>Seguidamente abrimos una consola y nos dirigimos a la carpeta recien creada para proceder a ejecutar:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">php composer install</code></pre></figure>

<p>Tal como indica la documentación oficial.</p>

<h4>Archivos del proyecto</h4>

<p>Debemos crear varios ficheros para poder ejecutar la aplicación, la estructura inicial de la que dispondremos es esta:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">|-- app
|    |-- AppKernel.php
|    |-- config
|    |     |--- config.yml
|    |-- Resources
|          |--- views
|                |--- home
|                      |--- index.html.twig
|-- src
|    |-- App
|         |--- Controller
|                   |------ HomeController.php
|-- web
     |-- index.php
</code></pre></div>
<p>A continuación se describe el contenido de cada fichero:</p>

<p><strong>app/AppKernel.php</strong></p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno"> 1</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 2</span> 
<span class="lineno"> 3</span> <span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Kernel\MicroKernelTrait</span><span class="p">;</span>
<span class="lineno"> 4</span> <span class="k">use</span> <span class="nx">Symfony\Component\Config\Loader\LoaderInterface</span><span class="p">;</span>
<span class="lineno"> 5</span> <span class="k">use</span> <span class="nx">Symfony\Component\DependencyInjection\ContainerBuilder</span><span class="p">;</span>
<span class="lineno"> 6</span> <span class="k">use</span> <span class="nx">Symfony\Component\HttpKernel\Kernel</span><span class="p">;</span>
<span class="lineno"> 7</span> <span class="k">use</span> <span class="nx">Symfony\Component\Routing\RouteCollectionBuilder</span><span class="p">;</span>
<span class="lineno"> 8</span> <span class="k">use</span> <span class="nx">Doctrine\Common\Annotations\AnnotationRegistry</span><span class="p">;</span>
<span class="lineno"> 9</span> 
<span class="lineno">10</span> <span class="c1">// require Composer&#39;s autoloader</span>
<span class="lineno">11</span> <span class="nv">$loader</span> <span class="o">=</span> <span class="k">require</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/../vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="lineno">12</span> <span class="c1">// auto-load annotations</span>
<span class="lineno">13</span> <span class="nx">AnnotationRegistry</span><span class="o">::</span><span class="na">registerLoader</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="nv">$loader</span><span class="p">,</span> <span class="s1">&#39;loadClass&#39;</span><span class="p">));</span>
<span class="lineno">14</span> 
<span class="lineno">15</span> <span class="k">class</span> <span class="nc">AppKernel</span> <span class="k">extends</span> <span class="nx">Kernel</span>
<span class="lineno">16</span> <span class="p">{</span>
<span class="lineno">17</span>     <span class="k">use</span> <span class="nx">MicroKernelTrait</span><span class="p">;</span>
<span class="lineno">18</span> 
<span class="lineno">19</span>     <span class="k">public</span> <span class="k">function</span> <span class="nf">registerBundles</span><span class="p">()</span>
<span class="lineno">20</span>     <span class="p">{</span>
<span class="lineno">21</span>         <span class="cm">/* Inicialmente vamos a trabajar con 3 bundles:</span>
<span class="lineno">22</span> <span class="cm">         * El Propio Framework, Twig</span>
<span class="lineno">23</span> <span class="cm">         * y Mejoras para controladores y dem�s.</span>
<span class="lineno">24</span> <span class="cm">         */</span>
<span class="lineno">25</span>         <span class="nv">$bundles</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">26</span>             <span class="k">new</span> <span class="nx">Symfony\Bundle\FrameworkBundle\FrameworkBundle</span><span class="p">(),</span>
<span class="lineno">27</span>             <span class="k">new</span> <span class="nx">Symfony\Bundle\TwigBundle\TwigBundle</span><span class="p">(),</span>
<span class="lineno">28</span>             <span class="k">new</span> <span class="nx">Sensio\Bundle\FrameworkExtraBundle\SensioFrameworkExtraBundle</span><span class="p">(),</span>
<span class="lineno">29</span>         <span class="p">);</span>
<span class="lineno">30</span> 
<span class="lineno">31</span>         <span class="k">return</span> <span class="nv">$bundles</span><span class="p">;</span>
<span class="lineno">32</span>     <span class="p">}</span>
<span class="lineno">33</span> 
<span class="lineno">34</span>     <span class="k">protected</span> <span class="k">function</span> <span class="nf">configureContainer</span><span class="p">(</span><span class="nx">ContainerBuilder</span> <span class="nv">$c</span><span class="p">,</span> <span class="nx">LoaderInterface</span> <span class="nv">$loader</span><span class="p">)</span>
<span class="lineno">35</span>     <span class="p">{</span>
<span class="lineno">36</span>         <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/config/config.yml&#39;</span><span class="p">);</span>
<span class="lineno">37</span>     <span class="p">}</span>
<span class="lineno">38</span> 
<span class="lineno">39</span>     <span class="k">protected</span> <span class="k">function</span> <span class="nf">configureRoutes</span><span class="p">(</span><span class="nx">RouteCollectionBuilder</span> <span class="nv">$routes</span><span class="p">)</span>
<span class="lineno">40</span>     <span class="p">{</span>
<span class="lineno">41</span>         <span class="c1">// Cargamos los controllers usando anotaciones</span>
<span class="lineno">42</span>         <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">import</span><span class="p">(</span><span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/../src/App/Controller/&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;annotation&#39;</span><span class="p">);</span>
<span class="lineno">43</span>     <span class="p">}</span>
<span class="lineno">44</span> <span class="p">}</span></code></pre></figure>

<p><strong>app/config/config.yml</strong></p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="lineno">1</span> <span class="l-Scalar-Plain">framework</span><span class="p-Indicator">:</span>
<span class="lineno">2</span>     <span class="l-Scalar-Plain">secret</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">StringAleatorio</span> <span class="c1"># Cambiar esto</span>
<span class="lineno">3</span>     <span class="l-Scalar-Plain">templating</span><span class="p-Indicator">:</span>
<span class="lineno">4</span>         <span class="l-Scalar-Plain">engines</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="s">&#39;twig&#39;</span><span class="p-Indicator">]</span>
<span class="lineno">5</span>     <span class="l-Scalar-Plain">profiler</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">only_exceptions</span><span class="p-Indicator">:</span> <span class="nv">false</span> <span class="p-Indicator">}</span></code></pre></figure>

<p><strong>web/index.php</strong></p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno"> 1</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 2</span> 
<span class="lineno"> 3</span> <span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Request</span><span class="p">;</span>
<span class="lineno"> 4</span> <span class="k">use</span> <span class="nx">Symfony\Component\Debug\Debug</span><span class="p">;</span>
<span class="lineno"> 5</span> 
<span class="lineno"> 6</span> <span class="k">require</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/../app/AppKernel.php&#39;</span><span class="p">;</span>
<span class="lineno"> 7</span> 
<span class="lineno"> 8</span> <span class="nx">Debug</span><span class="o">::</span><span class="na">enable</span><span class="p">();</span>
<span class="lineno"> 9</span> 
<span class="lineno">10</span> <span class="nv">$kernel</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AppKernel</span><span class="p">(</span><span class="s1">&#39;dev&#39;</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
<span class="lineno">11</span> <span class="nv">$request</span> <span class="o">=</span> <span class="nx">Request</span><span class="o">::</span><span class="na">createFromGlobals</span><span class="p">();</span>
<span class="lineno">12</span> <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$kernel</span><span class="o">-&gt;</span><span class="na">handle</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>
<span class="lineno">13</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
<span class="lineno">14</span> <span class="nv">$kernel</span><span class="o">-&gt;</span><span class="na">terminate</span><span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">);</span></code></pre></figure>

<p><strong>src/App/Controller/HomeController.php</strong></p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno"> 1</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 2</span> 
<span class="lineno"> 3</span> <span class="k">namespace</span> <span class="nx">App\Controller</span><span class="p">;</span>
<span class="lineno"> 4</span> 
<span class="lineno"> 5</span> <span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Controller\Controller</span><span class="p">;</span>
<span class="lineno"> 6</span> <span class="k">use</span> <span class="nx">Sensio\Bundle\FrameworkExtraBundle\Configuration\Route</span><span class="p">;</span>
<span class="lineno"> 7</span> 
<span class="lineno"> 8</span> <span class="k">class</span> <span class="nc">HomeController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="lineno"> 9</span> <span class="p">{</span>
<span class="lineno">10</span>     <span class="sd">/**</span>
<span class="lineno">11</span> <span class="sd">     * @Route(&quot;/&quot;, name=&quot;home&quot;)</span>
<span class="lineno">12</span> <span class="sd">     */</span>
<span class="lineno">13</span>     <span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">()</span>
<span class="lineno">14</span>     <span class="p">{</span>
<span class="lineno">15</span>         <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="s1">&#39;home/index.html.twig&#39;</span><span class="p">);</span>
<span class="lineno">16</span>     <span class="p">}</span>
<span class="lineno">17</span> <span class="p">}</span></code></pre></figure>

<p><strong>app/Resources/views/home/index.html.twig</strong></p>

<figure class="highlight"><pre><code class="language-jinja" data-lang="jinja"><span class="lineno">1</span> <span class="x">Hola Mundo!</span></code></pre></figure>

<p>Listo!, con estos archivos ya podemos correr nuestra aplicación y verificar que todo funcione correctamente.</p>

<h3>Ejecutando el proyecto:</h3>

<p>Para ejecutar el proyecto vamos hacer uso del servidor interno de php. Para lo cual nos vamos a colocar en la carpeta web del proyecto desde la consola y vamos a ejecutar:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">php -S localhost:8000
</code></pre></div>
<p>Si ahora vamos desde un navegador a <code>http://localhost:8000/</code> deberíamos tener como resultado el mensaje</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Hola Mundo!
</code></pre></div>
<p>Por ahora es todo! ya tenemos el proyecto configurado y funcionando con una página muy simple.</p>

<p>Para la segunda parte vamos a comenzar a crear los modelos y configurar algunos controladores</p>

        </section>

        

        <footer class="post-footer">
            
            <section class="author">
                <header> <a href="http://manuelj555.github.io/"> <img class="profile" src="/assets/images/profile.png" alt="Author's profile picture"></a></header>
                <article>
                    <h4> Manuel Aguirre <programador.manuel@gmail.com> </h4>
                    <p> 
                        Desarrollador Web, (PHP, HTML, css, javascript).<br/>
                        Intento usar Symfony2 y/o sus componentes en mis proyectos.<br/>
                        Apasionado por el aprendizaje y loco por la Programación :-)
                    </p>
                </article>
            </section>                
            

            <section class="share">
                <h4>Comparte</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=Creando un Foro con el MicroKernelTrait de Symfony (Parte 1)&amp;url=/2016/08/14/foro-micro-kernel-trait-symfony-parte-1.html"
                   onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');
                           return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=/2016/08/14/foro-micro-kernel-trait-symfony-parte-1.html"
                   onclick="window.open(this.href, 'facebook-share', 'width=580,height=296');
                           return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=/2016/08/14/foro-micro-kernel-trait-symfony-parte-1.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');
                           return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

            
            <section class="disqus">
                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'phpsymfonytipsmanuelj555'; // required: replace example with your forum shortname

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script');
                        dsq.type = 'text/javascript';
                        dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            </section>
            

        </footer>

    </article>

</main>


    <script type="text/javascript" src="/assets/js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Google Analytics Tracking code -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-59688229-1', 'auto');
        ga('send', 'pageview');

    </script>
</body>
</html>
